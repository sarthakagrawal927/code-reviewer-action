import { AuditLogRecord, GitHubInstallationRecord, GitHubWebhookEnvelope, IndexingJobRecord, PullRequestRecord, RepositoryConnection, RepositoryRuleOverride, ReviewFindingRecord, ReviewRunRecord, SessionRecord, UserRecord, WorkspaceInviteRecord, WorkspaceMemberRecord, WorkspaceRecord, WorkspaceRuleDefaults, WorkspaceSecretRecord } from '@code-reviewer/shared-types';
export type UpsertGithubUserInput = {
    githubUserId: string;
    githubLogin: string;
    displayName?: string;
    avatarUrl?: string;
    email?: string;
};
export type CreateSessionInput = {
    userId: string;
    sessionTokenHash: string;
    expiresAt: string;
    ipAddress?: string;
    userAgent?: string;
};
export type CreateWorkspaceInput = {
    slug: string;
    name: string;
    kind: WorkspaceRecord['kind'];
    githubAccountType?: WorkspaceRecord['githubAccountType'];
    githubAccountId?: string;
    createdByUserId: string;
};
export type AddWorkspaceMemberInput = {
    workspaceId: string;
    userId: string;
    githubUserId: string;
    githubLogin: string;
    role: WorkspaceMemberRecord['role'];
    status: WorkspaceMemberRecord['status'];
    invitedByUserId?: string;
};
export type CreateWorkspaceInviteInput = {
    workspaceId: string;
    inviteTokenHash: string;
    inviteeGithubLogin?: string;
    inviteeEmail?: string;
    role: WorkspaceInviteRecord['role'];
    invitedByUserId: string;
    expiresAt: string;
};
export type UpsertGitHubInstallationInput = {
    workspaceId: string;
    installationId: string;
    accountType: GitHubInstallationRecord['accountType'];
    accountId: string;
    accountLogin?: string;
};
export type UpsertRepositoryInput = {
    workspaceId: string;
    provider: RepositoryConnection['provider'];
    owner: string;
    name: string;
    fullName: string;
    githubRepoId?: string;
    installationId?: string;
    defaultBranch?: string;
    isPrivate?: boolean;
    isActive: boolean;
};
export type UpsertPullRequestInput = {
    repositoryId: string;
    githubPrId?: string;
    prNumber: number;
    title?: string;
    authorGithubLogin?: string;
    baseRef?: string;
    headRef?: string;
    headSha?: string;
    state: PullRequestRecord['state'];
    mergedAt?: string;
    closedAt?: string;
};
export type CreateReviewRunInput = {
    repositoryId: string;
    pullRequestId?: string;
    prNumber: number;
    headSha: string;
    triggerSource?: ReviewRunRecord['triggerSource'];
    status: ReviewRunRecord['status'];
    scoreVersion?: string;
    startedAt?: string;
};
export type UpsertWorkspaceRulesInput = Omit<WorkspaceRuleDefaults, 'updatedAt'> & {
    updatedAt?: string;
};
export type UpsertRepositoryRuleOverrideInput = Omit<RepositoryRuleOverride, 'updatedAt'> & {
    updatedAt?: string;
};
export type CreateIndexingRunInput = {
    repositoryId: string;
    status: IndexingJobRecord['status'];
    sourceRef?: string;
    summary?: Record<string, unknown>;
    startedAt?: string;
    completedAt?: string;
    errorMessage?: string;
};
export type CreateAuditLogInput = Omit<AuditLogRecord, 'id' | 'createdAt'> & {
    createdAt?: string;
};
export type UpsertWorkspaceSecretInput = Omit<WorkspaceSecretRecord, 'id' | 'createdAt' | 'updatedAt'>;
export type UpdateReviewRunPatch = Partial<Pick<ReviewRunRecord, 'status' | 'scoreComposite' | 'findingsCount' | 'completedAt' | 'errorMessage' | 'scoreVersion'>>;
export type UpdateIndexingRunPatch = Partial<Pick<IndexingJobRecord, 'status' | 'summary' | 'completedAt' | 'errorMessage'>>;
export interface ControlPlaneDatabase {
    upsertUserFromGithub(input: UpsertGithubUserInput): Promise<UserRecord>;
    getUserById(userId: string): Promise<UserRecord | undefined>;
    getUserByGithubId(githubUserId: string): Promise<UserRecord | undefined>;
    listUsers(): Promise<UserRecord[]>;
    createSession(input: CreateSessionInput): Promise<SessionRecord>;
    getSessionByTokenHash(sessionTokenHash: string): Promise<SessionRecord | undefined>;
    revokeSession(sessionId: string): Promise<SessionRecord | undefined>;
    listWorkspacesForUser(userId: string): Promise<WorkspaceRecord[]>;
    listAllWorkspaces(): Promise<WorkspaceRecord[]>;
    createWorkspace(input: CreateWorkspaceInput): Promise<WorkspaceRecord>;
    getWorkspaceById(workspaceId: string): Promise<WorkspaceRecord | undefined>;
    getWorkspaceBySlug(slug: string): Promise<WorkspaceRecord | undefined>;
    addWorkspaceMember(input: AddWorkspaceMemberInput): Promise<WorkspaceMemberRecord>;
    listWorkspaceMembers(workspaceId: string): Promise<WorkspaceMemberRecord[]>;
    getWorkspaceMember(workspaceId: string, userId: string): Promise<WorkspaceMemberRecord | undefined>;
    updateWorkspaceMember(workspaceId: string, memberId: string, patch: Partial<Pick<WorkspaceMemberRecord, 'role' | 'status'>>): Promise<WorkspaceMemberRecord | undefined>;
    createWorkspaceInvite(input: CreateWorkspaceInviteInput): Promise<WorkspaceInviteRecord>;
    getWorkspaceInviteByTokenHash(tokenHash: string): Promise<WorkspaceInviteRecord | undefined>;
    consumeWorkspaceInvite(inviteId: string, acceptedByUserId: string): Promise<WorkspaceInviteRecord | undefined>;
    listGitHubInstallations(workspaceId: string): Promise<GitHubInstallationRecord[]>;
    upsertGitHubInstallation(input: UpsertGitHubInstallationInput): Promise<GitHubInstallationRecord>;
    listRepositories(workspaceId: string): Promise<RepositoryConnection[]>;
    listAllRepositories(): Promise<RepositoryConnection[]>;
    upsertRepository(input: UpsertRepositoryInput): Promise<RepositoryConnection>;
    getRepositoryById(repositoryId: string): Promise<RepositoryConnection | undefined>;
    getRepositoryByFullName(workspaceId: string, fullName: string): Promise<RepositoryConnection | undefined>;
    getWorkspaceRuleDefaults(workspaceId: string): Promise<WorkspaceRuleDefaults | undefined>;
    upsertWorkspaceRuleDefaults(input: UpsertWorkspaceRulesInput): Promise<WorkspaceRuleDefaults>;
    getRepositoryRuleOverride(repositoryId: string): Promise<RepositoryRuleOverride | undefined>;
    upsertRepositoryRuleOverride(input: UpsertRepositoryRuleOverrideInput): Promise<RepositoryRuleOverride>;
    upsertPullRequest(input: UpsertPullRequestInput): Promise<PullRequestRecord>;
    getPullRequestById(pullRequestId: string): Promise<PullRequestRecord | undefined>;
    listPullRequestsByRepository(repositoryId: string): Promise<PullRequestRecord[]>;
    createReviewRun(input: CreateReviewRunInput): Promise<ReviewRunRecord>;
    getReviewRunById(reviewRunId: string): Promise<ReviewRunRecord | undefined>;
    updateReviewRun(reviewRunId: string, patch: UpdateReviewRunPatch): Promise<ReviewRunRecord | undefined>;
    listReviewRunsByPullRequest(pullRequestId: string): Promise<ReviewRunRecord[]>;
    listReviewRunsByRepository(repositoryId: string): Promise<ReviewRunRecord[]>;
    addReviewFinding(input: Omit<ReviewFindingRecord, 'id' | 'createdAt'> & {
        createdAt?: string;
    }): Promise<ReviewFindingRecord>;
    listReviewFindingsByRun(reviewRunId: string): Promise<ReviewFindingRecord[]>;
    createIndexingRun(input: CreateIndexingRunInput): Promise<IndexingJobRecord>;
    updateIndexingRun(indexingRunId: string, patch: UpdateIndexingRunPatch): Promise<IndexingJobRecord | undefined>;
    listIndexingRunsByRepository(repositoryId: string): Promise<IndexingJobRecord[]>;
    getWebhookEventByDeliveryId(provider: string, deliveryId: string): Promise<GitHubWebhookEnvelope | undefined>;
    recordWebhookEvent(input: GitHubWebhookEnvelope): Promise<GitHubWebhookEnvelope>;
    updateWebhookEvent(provider: string, deliveryId: string, patch: Partial<Pick<GitHubWebhookEnvelope, 'processingStatus' | 'processedAt' | 'signatureValid'>>): Promise<GitHubWebhookEnvelope | undefined>;
    appendAuditLog(input: CreateAuditLogInput): Promise<AuditLogRecord>;
    listAuditLogs(workspaceId: string, limit?: number): Promise<AuditLogRecord[]>;
    upsertWorkspaceSecret(input: UpsertWorkspaceSecretInput): Promise<WorkspaceSecretRecord>;
    getWorkspaceSecret(workspaceId: string, kind: WorkspaceSecretRecord['kind']): Promise<WorkspaceSecretRecord | undefined>;
}
export declare class InMemoryControlPlaneDatabase implements ControlPlaneDatabase {
    private users;
    private sessions;
    private workspaces;
    private workspaceMembers;
    private workspaceInvites;
    private githubInstallations;
    private repositories;
    private workspaceRuleDefaults;
    private repositoryRuleOverrides;
    private pullRequests;
    private reviewRuns;
    private reviewFindings;
    private indexingRuns;
    private webhookEvents;
    private auditLogs;
    private workspaceSecrets;
    upsertUserFromGithub(input: UpsertGithubUserInput): Promise<UserRecord>;
    getUserById(userId: string): Promise<UserRecord | undefined>;
    getUserByGithubId(githubUserId: string): Promise<UserRecord | undefined>;
    listUsers(): Promise<UserRecord[]>;
    createSession(input: CreateSessionInput): Promise<SessionRecord>;
    getSessionByTokenHash(sessionTokenHash: string): Promise<SessionRecord | undefined>;
    revokeSession(sessionId: string): Promise<SessionRecord | undefined>;
    listWorkspacesForUser(userId: string): Promise<WorkspaceRecord[]>;
    listAllWorkspaces(): Promise<WorkspaceRecord[]>;
    createWorkspace(input: CreateWorkspaceInput): Promise<WorkspaceRecord>;
    getWorkspaceById(workspaceId: string): Promise<WorkspaceRecord | undefined>;
    getWorkspaceBySlug(slug: string): Promise<WorkspaceRecord | undefined>;
    addWorkspaceMember(input: AddWorkspaceMemberInput): Promise<WorkspaceMemberRecord>;
    listWorkspaceMembers(workspaceId: string): Promise<WorkspaceMemberRecord[]>;
    getWorkspaceMember(workspaceId: string, userId: string): Promise<WorkspaceMemberRecord | undefined>;
    updateWorkspaceMember(workspaceId: string, memberId: string, patch: Partial<Pick<WorkspaceMemberRecord, 'role' | 'status'>>): Promise<WorkspaceMemberRecord | undefined>;
    createWorkspaceInvite(input: CreateWorkspaceInviteInput): Promise<WorkspaceInviteRecord>;
    getWorkspaceInviteByTokenHash(tokenHash: string): Promise<WorkspaceInviteRecord | undefined>;
    consumeWorkspaceInvite(inviteId: string, acceptedByUserId: string): Promise<WorkspaceInviteRecord | undefined>;
    listGitHubInstallations(workspaceId: string): Promise<GitHubInstallationRecord[]>;
    upsertGitHubInstallation(input: UpsertGitHubInstallationInput): Promise<GitHubInstallationRecord>;
    listRepositories(workspaceId: string): Promise<RepositoryConnection[]>;
    listAllRepositories(): Promise<RepositoryConnection[]>;
    upsertRepository(input: UpsertRepositoryInput): Promise<RepositoryConnection>;
    getRepositoryById(repositoryId: string): Promise<RepositoryConnection | undefined>;
    getRepositoryByFullName(workspaceId: string, fullName: string): Promise<RepositoryConnection | undefined>;
    getWorkspaceRuleDefaults(workspaceId: string): Promise<WorkspaceRuleDefaults | undefined>;
    upsertWorkspaceRuleDefaults(input: UpsertWorkspaceRulesInput): Promise<WorkspaceRuleDefaults>;
    getRepositoryRuleOverride(repositoryId: string): Promise<RepositoryRuleOverride | undefined>;
    upsertRepositoryRuleOverride(input: UpsertRepositoryRuleOverrideInput): Promise<RepositoryRuleOverride>;
    upsertPullRequest(input: UpsertPullRequestInput): Promise<PullRequestRecord>;
    getPullRequestById(pullRequestId: string): Promise<PullRequestRecord | undefined>;
    listPullRequestsByRepository(repositoryId: string): Promise<PullRequestRecord[]>;
    createReviewRun(input: CreateReviewRunInput): Promise<ReviewRunRecord>;
    getReviewRunById(reviewRunId: string): Promise<ReviewRunRecord | undefined>;
    updateReviewRun(reviewRunId: string, patch: UpdateReviewRunPatch): Promise<ReviewRunRecord | undefined>;
    listReviewRunsByPullRequest(pullRequestId: string): Promise<ReviewRunRecord[]>;
    listReviewRunsByRepository(repositoryId: string): Promise<ReviewRunRecord[]>;
    addReviewFinding(input: Omit<ReviewFindingRecord, 'id' | 'createdAt'> & {
        createdAt?: string;
    }): Promise<ReviewFindingRecord>;
    listReviewFindingsByRun(reviewRunId: string): Promise<ReviewFindingRecord[]>;
    createIndexingRun(input: CreateIndexingRunInput): Promise<IndexingJobRecord>;
    updateIndexingRun(indexingRunId: string, patch: UpdateIndexingRunPatch): Promise<IndexingJobRecord | undefined>;
    listIndexingRunsByRepository(repositoryId: string): Promise<IndexingJobRecord[]>;
    getWebhookEventByDeliveryId(provider: string, deliveryId: string): Promise<GitHubWebhookEnvelope | undefined>;
    recordWebhookEvent(input: GitHubWebhookEnvelope): Promise<GitHubWebhookEnvelope>;
    updateWebhookEvent(provider: string, deliveryId: string, patch: Partial<Pick<GitHubWebhookEnvelope, 'processingStatus' | 'processedAt' | 'signatureValid'>>): Promise<GitHubWebhookEnvelope | undefined>;
    appendAuditLog(input: CreateAuditLogInput): Promise<AuditLogRecord>;
    listAuditLogs(workspaceId: string, limit?: number): Promise<AuditLogRecord[]>;
    upsertWorkspaceSecret(input: UpsertWorkspaceSecretInput): Promise<WorkspaceSecretRecord>;
    getWorkspaceSecret(workspaceId: string, kind: WorkspaceSecretRecord['kind']): Promise<WorkspaceSecretRecord | undefined>;
}
